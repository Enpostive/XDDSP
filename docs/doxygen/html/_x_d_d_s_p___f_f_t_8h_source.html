<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XDDSP: /Users/adam/Documents/Development/XDDSP/XDDSP_FFT.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">XDDSP
   </div>
   <div id="projectbrief">A not-so-simple C++ template library for creating complex DSP networks.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_x_d_d_s_p___f_f_t_8h_source.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">/Users/adam/Documents/Development/XDDSP/XDDSP_FFT.h</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">//</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//  FFT.h</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">//  XDDSPLib</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">//</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">//  Created by Adam Jackson on 3/1/22.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">//</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#ifndef FFT_h</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#define FFT_h</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &lt;thread&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &quot;XDDSP_Types.h&quot;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &quot;XDDSP_Parameters.h&quot;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &quot;XDDSP_Functions.h&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_x_d_d_s_p.html">XDDSP</a> {</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="foldopen" id="foldopen00024" data-start="{" data-end="}">
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p_1_1_f_f_t_constants.html">   24</a></span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_x_d_d_s_p_1_1_f_f_t_constants.html">FFTConstants</a> {</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> sqrt2 = 1.414213562373095;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> recSqrt2 = 1./sqrt2;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>}</div>
</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00044" data-start="{" data-end="}">
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#ab967fac6eda3e8d7d43c4f9db061e1ef">   44</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#ab967fac6eda3e8d7d43c4f9db061e1ef">fftDynamicSize</a>(T *data, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n, <span class="keywordtype">bool</span> normalise = <span class="keyword">true</span>)</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>{</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i, j, k, i5, i6, i7, i8, i0, iD, i1, i2, i3, i4, n2, n4, n8;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> T t1, t2, t3, t4, t5, t6, a3, ss1, ss3, cc1, cc3, a, e;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> n4 = n - 1;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> <span class="comment">//data shuffling</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> <span class="keywordflow">for</span> (i = 0, j = 0, n2 = n/2;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>      i&lt;n4;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>      i++)</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> {</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>  <span class="keywordflow">if</span> (i &lt; j)</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>  {</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>   t1 = data[j];</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>   data[j] = data[i];</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>   data[i] = t1;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>  }</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>  k = n2;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>  <span class="keywordflow">while</span> (k &lt;= j)</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>  {</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>   j -= k;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>   k &gt;&gt;= 1;</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>  }</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>  j += k;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> }</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span> </div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> <span class="comment">/*----------------------*/</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> <span class="comment">//length two butterflies</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span> i0 = 0;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> iD = 4;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> <span class="keywordflow">do</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> {</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>  <span class="keywordflow">for</span> (; i0 &lt; n4; i0 += iD)</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>  {</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>   i1 = i0 + 1;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>   t1 = data[i0];</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>   data[i0] = t1 + data[i1];</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>   data[i1] = t1 - data[i1];</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>  }</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>  iD &lt;&lt;= 1;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>  i0 = iD - 2;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>  iD &lt;&lt;= 1;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span> } <span class="keywordflow">while</span> (i0 &lt; n4);</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span> </div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> <span class="comment">/*----------------------*/</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> <span class="comment">//L shaped butterflies</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span> n2 = 2;</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span> <span class="keywordflow">for</span>(k = n; k &gt; 2; k &gt;&gt;= 1)</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> {</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>  n2 &lt;&lt;= 1;</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>  n4 = n2&gt;&gt;2;</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>  n8 = n2&gt;&gt;3;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>  e = 2*M_PI/(n2);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>  i1 = 0;</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>  iD = n2&lt;&lt;1;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>  <span class="keywordflow">do</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>  {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>   <span class="keywordflow">for</span> (; i1 &lt; n; i1 += iD)</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>   {</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    i2 = i1 + n4;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    i3 = i2 + n4;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    i4 = i3 + n4;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>    t1 = data[i4] + data[i3];</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    data[i4] -= data[i3];</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    data[i3] = data[i1]-t1;</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    data[i1] += t1;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <span class="keywordflow">if</span> (n4 != 1)</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    {</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>     i0 = i1 + n8;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>     i2 += n8;</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>     i3 += n8;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>     i4 += n8;</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>     t1 = (data[i3] + data[i4])*FFTConstants::recSqrt2;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>     t2 = (data[i3] - data[i4])*FFTConstants::recSqrt2;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>     data[i4] = data[i2] - t1;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>     data[i3] =- data[i2] - t1;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>     data[i2] = data[i0] - t2;</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>     data[i0] += t2;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    }</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>   }</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>   iD &lt;&lt;= 1;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>   i1 = iD - n2;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>   iD &lt;&lt;= 1;</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>  } <span class="keywordflow">while</span> (i1 &lt; n);</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>  a = e;</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>  <span class="keywordflow">for</span> (j = 2; j &lt;= n8; j++)</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>  {</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>   a3 = 3*a;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>   cc1 = std::cos(a);</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>   ss1 = std::sin(a);</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>   cc3 = std::cos(a3);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>   ss3 = std::sin(a3);</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>   a = j*e;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>   i = 0;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>   iD = n2&lt;&lt;1;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>   <span class="keywordflow">do</span></div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>   {</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    <span class="keywordflow">for</span> (; i &lt; n; i += iD)</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    {</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>     i1 = i + j - 1;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>     i2 = i1 + n4;</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>     i3 = i2 + n4;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>     i4 = i3 + n4;</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>     i5 = i + n4 - j + 1;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>     i6 = i5 + n4;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>     i7 = i6 + n4;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>     i8 = i7 + n4;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>     t1 = data[i3]*cc1 + data[i7]*ss1;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>     t2 = data[i7]*cc1 - data[i3]*ss1;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>     t3 = data[i4]*cc3 + data[i8]*ss3;</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>     t4 = data[i8]*cc3 - data[i4]*ss3;</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>     t5 = t1 + t3;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>     t6 = t2 + t4;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>     t3 = t1 - t3;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>     t4 = t2 - t4;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>     t2 = data[i6] + t6;</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>     data[i3] = t6 - data[i6];</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>     data[i8] = t2;</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>     t2 = data[i2] - t3;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>     data[i7] =- data[i2] - t3;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>     data[i4] = t2;</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>     t1 = data[i1] + t5;</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>     data[i6] = data[i1] - t5;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>     data[i1] = t1;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>     t1 = data[i5] + t4;</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>     data[i5] -= t4;</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>     data[i2] = t1;</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    }</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    iD &lt;&lt;= 1;</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    i = iD - n2;</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    iD &lt;&lt;= 1;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>   } <span class="keywordflow">while</span>(i &lt; n);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>  }</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> }</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span> </div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span> <span class="keywordflow">if</span> (normalise)</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span> {</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>  T nRec = 1./<span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(n);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>  <span class="keywordflow">for</span> (i = 0; i &lt; n; ++i) data[i] *= nRec;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> }</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>}</div>
</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00207" data-start="{" data-end="}">
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#a0759011c633e1819484046214fbc3720">  207</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#a0759011c633e1819484046214fbc3720">ifftDynamicSize</a>(T *data, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>{</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span> <span class="keywordtype">long</span> i, j, k, i5, i6, i7, i8, i0, iD, i1, i2, i3, i4, n2, n4, n8, n1;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> T t1, t2, t3, t4, t5, a3, ss1, ss3, cc1, cc3, a, e;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span> n1 = n - 1;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> n2 = n&lt;&lt;1;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span> <span class="keywordflow">for</span>(k = n; k &gt; 2; k &gt;&gt;= 1)</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> {</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>  iD = n2;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>  n2 &gt;&gt;= 1;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>  n4 = n2 &gt;&gt; 2;</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>  n8 = n2 &gt;&gt; 3;</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>  e = 2.*M_PI/(n2);</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>  i1 = 0;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>  <span class="keywordflow">do</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>  {</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>   <span class="keywordflow">for</span> (; i1 &lt; n; i1 += iD)</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>   {</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    i2 = i1 + n4;</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    i3 = i2 + n4;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    i4 = i3 + n4;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    t1 = data[i1] - data[i3];</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    data[i1] += data[i3];</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    data[i2] *= 2.;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    data[i3] = t1 - 2.*data[i4];</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    data[i4] = t1 + 2.*data[i4];</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <span class="keywordflow">if</span> (n4 != 1)</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    {</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>     i0 = i1 + n8;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>     i2 += n8;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>     i3 += n8;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>     i4 += n8;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>     t1 = (data[i2] - data[i0])*FFTConstants::recSqrt2;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>     t2 = (data[i4] + data[i3])*FFTConstants::recSqrt2;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>     data[i0] += data[i2];</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>     data[i2] = data[i4] - data[i3];</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>     data[i3] = 2.*(-t2 - t1);</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>     data[i4] = 2.*(-t2 + t1);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    }</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>   }</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>   iD &lt;&lt;= 1;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>   i1 = iD - n2;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>   iD &lt;&lt;= 1;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>  } <span class="keywordflow">while</span> (i1 &lt; n1);</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>  a = e;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>  <span class="keywordflow">for</span> (j = 2; j &lt;= n8; ++j)</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>  {</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>   a3 = 3.*a;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>   cc1 = std::cos(a);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>   ss1 = std::sin(a);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>   cc3 = std::cos(a3);</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>   ss3 = std::sin(a3);</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>   a = j*e;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>   i = 0;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>   iD = n2&lt;&lt;1;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>   <span class="keywordflow">do</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>   {</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    <span class="keywordflow">for</span> (; i &lt; n; i += iD)</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    {</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>     i1 = i + j - 1;</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>     i2 = i1 + n4;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>     i3 = i2 + n4;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>     i4 = i3 + n4;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>     i5 = i + n4 - j + 1;</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>     i6 = i5 + n4;</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>     i7 = i6 + n4;</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>     i8 = i7 + n4;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>     t1 = data[i1] - data[i6];</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>     data[i1] += data[i6];</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>     t2 = data[i5] - data[i2];</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>     data[i5] += data[i2];</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>     t3 = data[i8] + data[i3];</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>     data[i6] = data[i8] - data[i3];</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>     t4 = data[i4] + data[i7];</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>     data[i2] = data[i4] - data[i7];</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>     t5 = t1 - t4;</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>     t1 += t4;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>     t4 = t2 - t3;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>     t2 += t3;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>     data[i3] = t5*cc1 + t4*ss1;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>     data[i7] = -t4*cc1 + t5*ss1;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>     data[i4] = t1*cc3 - t2*ss3;</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>     data[i8] = t2*cc3 + t1*ss3;</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    }</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>    iD &lt;&lt;= 1;</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    i = iD - n2;</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    iD &lt;&lt;= 1;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>   } <span class="keywordflow">while</span>(i &lt; n1);</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>  }</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> }</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> i0 = 0;</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span> iD = 4;</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span> <span class="keywordflow">do</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span> {</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>  <span class="keywordflow">for</span> (; i0 &lt; n1; i0 += iD)</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>  {</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>   i1 = i0 + 1;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>   t1 = data[i0];</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>   data[i0] = t1 + data[i1];</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>   data[i1] = t1 - data[i1];</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>  }</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>  iD &lt;&lt;= 1;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>  i0 = iD - 2;</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  iD &lt;&lt;= 1;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> } <span class="keywordflow">while</span> (i0 &lt; n1);</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span> </div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span> </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span> <span class="comment">// Data shuffling</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span> <span class="keywordflow">for</span> (i = 0, j = 0, n2 = n/2;</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>      i&lt;n1;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>      ++i)</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> {</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>  <span class="keywordflow">if</span> (i &lt; j) std::swap(data[j], data[i]);</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>  k = n2;</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>  <span class="keywordflow">while</span> (k &lt;= j)</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>  {</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>   j -= k;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>   k &gt;&gt;= 1;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>  }</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>  j += k;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> }</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>}</div>
</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span> </div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span> </div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span> </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span> </div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span> </div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span> </div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n&gt;</div>
<div class="foldopen" id="foldopen00352" data-start="{" data-end="}">
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#a6cf696b87a8fbae2251aa09ca0689104">  352</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#a6cf696b87a8fbae2251aa09ca0689104">fftStaticSize</a>(std::array&lt;T, n&gt; &amp;data, <span class="keywordtype">bool</span> normalise = <span class="keyword">true</span>)</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>{</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#ab967fac6eda3e8d7d43c4f9db061e1ef">fftDynamicSize</a>(data.data(), data.size(), normalise);</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>}</div>
</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00367" data-start="{" data-end="}">
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#ad76647b135a18390ad9d051a97397e0f">  367</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#ab967fac6eda3e8d7d43c4f9db061e1ef">fftDynamicSize</a>(std::vector&lt;T&gt; &amp;data, <span class="keywordtype">bool</span> normalise = <span class="keyword">true</span>)</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>{</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#ab967fac6eda3e8d7d43c4f9db061e1ef">fftDynamicSize</a>(data.data(), data.size(), normalise);</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>}</div>
</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span> </div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span> </div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span> </div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span> </div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span> </div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n&gt;</div>
<div class="foldopen" id="foldopen00390" data-start="{" data-end="}">
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#aaf6a3faaf5f63e44e0684a1f6f632427">  390</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#aaf6a3faaf5f63e44e0684a1f6f632427">ifftStaticSize</a>(std::array&lt;T, n&gt; &amp;data)</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>{</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#a0759011c633e1819484046214fbc3720">ifftDynamicSize</a>(data.data(), data.size());</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>}</div>
</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00404" data-start="{" data-end="}">
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#ae742e09f1ba85045aa0673a52a33cee3">  404</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#a0759011c633e1819484046214fbc3720">ifftDynamicSize</a>(std::vector&lt;T&gt; &amp;data)</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>{</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#a0759011c633e1819484046214fbc3720">ifftDynamicSize</a>(data.data(), data.size());</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>}</div>
</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span> </div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span> </div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span> </div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span> </div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span> </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span> </div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span></div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00428" data-start="{" data-end="}">
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#a2f46009fa77b26f0939f3f02d9db9d8d">  428</a></span>std::pair&lt;T, T&gt; <a class="code hl_function" href="namespace_x_d_d_s_p.html#a2f46009fa77b26f0939f3f02d9db9d8d">getComplexSample</a>(T* data, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> index, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>{</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span> <span class="keywordflow">if</span> (index == 0) <span class="keywordflow">return</span> {data[0], 0.};</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span> <span class="keywordflow">if</span> (index == n/2) <span class="keywordflow">return</span> {data[n/2], 0.};</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> <span class="keywordflow">return</span> {data[index], data[n - index]};</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>}</div>
</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span> </div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span> </div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span> </div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span> </div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00454" data-start="{" data-end="}">
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#a301ddf32610b2c3725c8f42064350a23">  454</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#a301ddf32610b2c3725c8f42064350a23">multiplyFFTs</a>(T* output, T* in1, T* in2, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>{</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span> output[0] = in1[0] * in2[0];</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span> output[n/2] = in1[n/2] * in2[n/2];</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> p = 1; p &lt; n/2; ++p)</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span> {</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> p2 = n - p;</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>  <span class="comment">// Complex multipliction formula</span></div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>  <span class="comment">// x + yi = (a + bi)(c + di)</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>  <span class="comment">//        = (ac - bd) + (ad + bc)i</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>  <span class="keyword">const</span> T a = in1[p];</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>  <span class="keyword">const</span> T b = in1[p2];</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>  <span class="keyword">const</span> T c = in2[p];</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>  <span class="keyword">const</span> T d = in2[p2];</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>  </div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>  <span class="comment">// x = ac - bd</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>  output[p] = std::fma(a, c, -b*d);</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>  <span class="comment">// y = ad + bc</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>  output[p2] = std::fma(a, d, b*c);</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span> }</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>}</div>
</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span> </div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span> </div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span> </div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span> </div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span> </div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span> </div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00495" data-start="{" data-end="}">
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#a13223a5b4d04516032a1c4f98aeedfeb">  495</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#a13223a5b4d04516032a1c4f98aeedfeb">multiplyAndAddFFTs</a>(T* output, T* in1, T* in2, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>{</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span> output[0] += in1[0] * in2[0];</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> output[n/2] += in1[n/2] * in2[n/2];</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> p = 1; p &lt; n/2; ++p)</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span> {</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> p2 = n - p;</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>  <span class="keyword">const</span> T a = in1[p];</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>  <span class="keyword">const</span> T b = in1[p2];</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>  <span class="keyword">const</span> T c = in2[p];</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>  <span class="keyword">const</span> T d = in2[p2];</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>  </div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>  <span class="comment">// x += ac - bd</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>  output[p] = std::fma(a, c, output[p]);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>  output[p] = std::fma(-b, d, output[p]);</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>  <span class="comment">// y += ad + bc</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>  output[p2] = std::fma(a, d, output[p2]);</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>  output[p2] = std::fma(b, c, output[p2]);</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span> }</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>}</div>
</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span> </div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span> </div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span> </div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span> </div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span> </div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span> </div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span> </div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span> </div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00535" data-start="{" data-end="}">
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#a928440e390d14ed481c7743382c72c7f">  535</a></span>T <a class="code hl_function" href="namespace_x_d_d_s_p.html#a928440e390d14ed481c7743382c72c7f">magnitudeAt</a>(T* data, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> index, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>{</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span> <span class="keyword">auto</span> sample = <a class="code hl_function" href="namespace_x_d_d_s_p.html#a2f46009fa77b26f0939f3f02d9db9d8d">getComplexSample</a>(data, index, n);</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span> T magSqr = sample.first*sample.first + sample.second*sample.second;</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span> <span class="keywordflow">return</span> sqrt(magSqr);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>}</div>
</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span> </div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span> </div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span> </div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span> </div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span> </div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span> </div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span></div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00559" data-start="{" data-end="}">
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#af74876c324ecde0826f5c56df11061af">  559</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#af74876c324ecde0826f5c56df11061af">calculateMagnitudes</a>(T* data, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>{</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span> <span class="keywordtype">int</span> i;</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> <span class="keywordflow">for</span> (i = 0; i &lt; n/2; ++i)</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span> {</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>  data[i] = <a class="code hl_function" href="namespace_x_d_d_s_p.html#a928440e390d14ed481c7743382c72c7f">magnitudeAt</a>(data, i, n);</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span> }</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span> <span class="keywordflow">for</span> (;i &lt; n; ++i)</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span> {</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>  data[i] = 0.;</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span> }</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>}</div>
</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span> </div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span> </div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span> </div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span> </div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span> </div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span> </div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span> </div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span> </div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span> </div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span> </div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00591" data-start="{" data-end="}">
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#ad2f74eac40d5e02fc4b1d798f850f7a7">  591</a></span>T <a class="code hl_function" href="namespace_x_d_d_s_p.html#ad2f74eac40d5e02fc4b1d798f850f7a7">autoCorrelateDynamicSizeHalved</a>(T *data, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>{</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nHalved = n/2;</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span> </div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#ab967fac6eda3e8d7d43c4f9db061e1ef">fftDynamicSize</a>(data, n);</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span> </div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span> <span class="comment">// Multiply by conjugate</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i = 0; i &lt; nHalved; ++i)</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span> {</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>  data[i] = data[i]*data[i] + data[n - i - 1]*data[n - i - 1];</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>  data[n - i - 1] = 0.;</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span> }</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span> data[0] = data[1] = 0.;</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#a0759011c633e1819484046214fbc3720">ifftDynamicSize</a>(data, n);</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span> </div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span> T norm = data[0];</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span> <span class="keywordflow">if</span> (norm &gt; 0.) norm = 1./norm;</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i = 0; i &lt; nHalved; ++i)</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span> {</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>  data[i] = data[i]*norm;</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span> }</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span> </div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> maxima = 1;</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span> <span class="keyword">constexpr</span> T threshold = 0.8;</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span> <span class="keywordflow">while</span> (maxima &lt; nHalved &amp;&amp; data[maxima] &gt;= threshold) ++ maxima;</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span> <span class="keywordflow">while</span> (maxima &lt; nHalved &amp;&amp; data[maxima] &lt; threshold) ++maxima;</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span> <span class="keywordflow">while</span> (maxima &lt; nHalved &amp;&amp; data[maxima - 1] &lt;= data[maxima]) ++ maxima;</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span> <span class="keywordflow">if</span> (data[maxima-2] &gt; data[maxima]) --maxima;</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span> </div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span> T fMaxima = -1;</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span> </div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span> <span class="keywordflow">if</span> (maxima &lt; nHalved - 1)</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span> {</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>  T maxima1;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>  <a class="code hl_class" href="class_x_d_d_s_p_1_1_intersection_estimator.html">XDDSP::IntersectionEstimator</a> intersect;</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>  intersect.<a class="code hl_function" href="class_x_d_d_s_p_1_1_intersection_estimator.html#ad235d4e66a6bd90de32afa1b0ad1a808">setSampleValues</a>(data[maxima - 2],</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>                            data[maxima - 1],</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>                            data[maxima],</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>                            data[maxima + 1]);</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>  </div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>  intersect.calculateStationaryPoints(fMaxima, maxima1);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>  fMaxima = maxima + maxima1 - 2.;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span> }</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span> </div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span> <span class="keywordflow">return</span> fMaxima;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>}</div>
</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span></div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n&gt;</div>
<div class="foldopen" id="foldopen00648" data-start="{" data-end="}">
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#a5b9681700449b15a061db6007d0815c2">  648</a></span>T <a class="code hl_function" href="namespace_x_d_d_s_p.html#a5b9681700449b15a061db6007d0815c2">autoCorrelateStaticSizeHalved</a>(std::array&lt;T, n&gt; &amp;data)</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>{</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span> <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#ad2f74eac40d5e02fc4b1d798f850f7a7">autoCorrelateDynamicSizeHalved</a>(data.data(), n);</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>}</div>
</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00661" data-start="{" data-end="}">
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p.html#a83519386b0c744ec1c58e02a9f22e26a">  661</a></span>T <a class="code hl_function" href="namespace_x_d_d_s_p.html#ad2f74eac40d5e02fc4b1d798f850f7a7">autoCorrelateDynamicSizeHalved</a>(std::vector&lt;T&gt; &amp;data)</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>{</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span> <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_x_d_d_s_p.html#ad2f74eac40d5e02fc4b1d798f850f7a7">autoCorrelateDynamicSizeHalved</a>(data.data(), data.size());</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>}</div>
</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span> </div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span><span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> SampleLength&gt;</div>
<div class="foldopen" id="foldopen00673" data-start="{" data-end="};">
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_auto_correlator.html">  673</a></span><span class="keyword">class </span><a class="code hl_function" href="class_x_d_d_s_p_1_1_auto_correlator.html#a8287fc31b918f38e058d8593c414dc36">AutoCorrelator</a></div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>{</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span> <a class="code hl_class" href="class_x_d_d_s_p_1_1_parameters.html">Parameters</a> &amp;dspParam;</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span> std::array&lt;SampleType, 2*SampleLength&gt; buffer;</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span> </div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span><span class="keyword">public</span>:</div>
<div class="foldopen" id="foldopen00684" data-start="{" data-end="}">
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_auto_correlator.html#a8287fc31b918f38e058d8593c414dc36">  684</a></span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_auto_correlator.html#a8287fc31b918f38e058d8593c414dc36">AutoCorrelator</a>(<a class="code hl_class" href="class_x_d_d_s_p_1_1_parameters.html">Parameters</a> &amp;p) : dspParam(p)</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span> {}</div>
</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span> </div>
<div class="foldopen" id="foldopen00694" data-start="{" data-end="}">
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_auto_correlator.html#afa38ee688de74d2b6372b08df8fbed71">  694</a></span> SampleType <a class="code hl_function" href="class_x_d_d_s_p_1_1_auto_correlator.html#afa38ee688de74d2b6372b08df8fbed71">autoCorrelate</a>(SampleType *data, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> length)</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span> {</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>  <span class="keywordflow">if</span> (length &gt; SampleLength) length = SampleLength;</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span> </div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>  std::copy(data, data + length, buffer.begin());</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>  std::fill(buffer.begin() + length, buffer.end(), 0.);</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>  <a class="code hl_function" href="namespace_x_d_d_s_p.html#a32fa51674b6f683796cc7417542e97dc">applyWindowFunction</a>(<a class="code hl_class" href="class_x_d_d_s_p_1_1_window_function_1_1_gauss.html">WindowFunction::Gauss</a>(length, 0.3), buffer.data(), length);</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>  SampleType a = <a class="code hl_function" href="namespace_x_d_d_s_p.html#a5b9681700449b15a061db6007d0815c2">autoCorrelateStaticSizeHalved</a>(buffer);</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>  <span class="keywordflow">if</span> (a &gt; 0) a = dspParam.sampleRate()/a;</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>  <span class="keywordflow">return</span> a;</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span> }</div>
</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span> </div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span> <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n&gt;</div>
<div class="foldopen" id="foldopen00714" data-start="{" data-end="}">
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_auto_correlator.html#a2e65224404879ef93088566fca7ed9f0">  714</a></span> SampleType <a class="code hl_function" href="class_x_d_d_s_p_1_1_auto_correlator.html#a2e65224404879ef93088566fca7ed9f0">autoCorrelate</a>(std::array&lt;SampleType, n&gt; &amp;data)</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span> { <span class="keywordflow">return</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_auto_correlator.html#afa38ee688de74d2b6372b08df8fbed71">autoCorrelate</a>(data.data(), n); }</div>
</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span> </div>
<div class="foldopen" id="foldopen00723" data-start="{" data-end="}">
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_auto_correlator.html#a3596b2dcaf3a3b0a6309288d8874eee4">  723</a></span>SampleType <a class="code hl_function" href="class_x_d_d_s_p_1_1_auto_correlator.html#a3596b2dcaf3a3b0a6309288d8874eee4">autoCorrelate</a>(std::vector&lt;SampleType&gt; &amp;data)</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span> { <span class="keywordflow">return</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_auto_correlator.html#afa38ee688de74d2b6372b08df8fbed71">autoCorrelate</a>(data.data(), data.size()); }</div>
</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>};</div>
</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span> </div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span> </div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span> </div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span> </div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span> </div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span> </div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span> </div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span> </div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span> </div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span></div>
<div class="foldopen" id="foldopen00740" data-start="{" data-end="};">
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html">  740</a></span><span class="keyword">class </span><a class="code hl_function" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#ac05355d6e611550d757a4384e809291b">DynamicAutoCorrelator</a></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>{</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span> <a class="code hl_class" href="class_x_d_d_s_p_1_1_parameters.html">Parameters</a> &amp;dspParam;</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> sampleLength {0};</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span> std::vector&lt;SampleType&gt; buffer;</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span> </div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span><span class="keyword">public</span>:</div>
<div class="foldopen" id="foldopen00752" data-start="{" data-end="}">
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#ac05355d6e611550d757a4384e809291b">  752</a></span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#ac05355d6e611550d757a4384e809291b">DynamicAutoCorrelator</a>(<a class="code hl_class" href="class_x_d_d_s_p_1_1_parameters.html">Parameters</a> &amp;p) : dspParam(p)</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span> {}</div>
</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span> </div>
<div class="foldopen" id="foldopen00760" data-start="{" data-end="}">
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#a11a090d6e3b03be1ccecc92b2b71ed1d">  760</a></span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#a11a090d6e3b03be1ccecc92b2b71ed1d">setBufferSize</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> bufferSize)</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span> {</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>  sampleLength = bufferSize;</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>  buffer.resize(2*bufferSize, 0.);</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span> }</div>
</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span> </div>
<div class="foldopen" id="foldopen00773" data-start="{" data-end="}">
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#af67e952bf8bdeb915e8e262a0c290430">  773</a></span> SampleType <a class="code hl_function" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#af67e952bf8bdeb915e8e262a0c290430">autoCorrelate</a>(SampleType *data, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> length)</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span> {</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>  <span class="keywordflow">if</span> (length &gt; sampleLength) length = sampleLength;</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span> </div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span> </div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>  std::copy(data, data + length, buffer.begin());</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>  std::fill(buffer.begin() + length, buffer.end(), 0.);</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>  <a class="code hl_function" href="namespace_x_d_d_s_p.html#a32fa51674b6f683796cc7417542e97dc">applyWindowFunction</a>(<a class="code hl_class" href="class_x_d_d_s_p_1_1_window_function_1_1_gauss.html">WindowFunction::Gauss</a>(length, 0.3), buffer.data(), length);</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>  SampleType a = <a class="code hl_function" href="namespace_x_d_d_s_p.html#ad2f74eac40d5e02fc4b1d798f850f7a7">autoCorrelateDynamicSizeHalved</a>(buffer);</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>  <span class="keywordflow">if</span> (a &gt; 0) a = dspParam.sampleRate()/a;</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>  <span class="keywordflow">return</span> a;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span> }</div>
</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span> </div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span> <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n&gt;</div>
<div class="foldopen" id="foldopen00794" data-start="{" data-end="}">
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#ae481b84d7754d80e6d099d8966201c50">  794</a></span> SampleType <a class="code hl_function" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#ae481b84d7754d80e6d099d8966201c50">autoCorrelate</a>(std::array&lt;SampleType, n&gt; &amp;data)</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span> { <span class="keywordflow">return</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#af67e952bf8bdeb915e8e262a0c290430">autoCorrelate</a>(data.data(), n); }</div>
</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span> </div>
<div class="foldopen" id="foldopen00803" data-start="{" data-end="}">
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#a93da389f639dcd5faed37b126f9a1ea5">  803</a></span> SampleType <a class="code hl_function" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#a93da389f639dcd5faed37b126f9a1ea5">autoCorrelate</a>(std::vector&lt;SampleType&gt; &amp;data)</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span> { <span class="keywordflow">return</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#af67e952bf8bdeb915e8e262a0c290430">autoCorrelate</a>(data.data(), data.size()); }</div>
</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>};</div>
</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span> </div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span> </div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span> </div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span> </div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span> </div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span> </div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span> </div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span> </div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span> </div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span> </div>
<div class="foldopen" id="foldopen00816" data-start="{" data-end="}">
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno"><a class="line" href="namespace_x_d_d_s_p_1_1_convolution_engine.html">  816</a></span><span class="keyword">namespace </span><a class="code hl_class" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html">ConvolutionEngine</a></div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>{</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span></div>
<div class="foldopen" id="foldopen00823" data-start="{" data-end="};">
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno"><a class="line" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html">  823</a></span><span class="keyword">struct </span><a class="code hl_struct" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html">KernelContainer</a></div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>{</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span> std::vector&lt;std::vector&lt;SampleType&gt;&gt; k;</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span> </div>
<div class="foldopen" id="foldopen00828" data-start="{" data-end="}">
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno"><a class="line" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html#abbd3f3daaa17b1b9488a00d775870a82">  828</a></span> <span class="keywordtype">void</span> <a class="code hl_function" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html#abbd3f3daaa17b1b9488a00d775870a82">setup</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kernelCount, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kernelSize)</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span> {</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>  k.resize(kernelCount);</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;kk: k) kk.resize(kernelSize, 0.);</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span> }</div>
</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span> </div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno"><a class="line" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html#ac0cc7eb9849f491a5e79e29acc0c7247">  835</a></span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html#ac0cc7eb9849f491a5e79e29acc0c7247">size</a>() { <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(k.size()); }</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span> </div>
<div class="foldopen" id="foldopen00838" data-start="{" data-end="}">
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno"><a class="line" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html#a6e9ca1d377f5b7726a777d21a73873f5">  838</a></span> SampleType *<a class="code hl_function" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html#a6e9ca1d377f5b7726a777d21a73873f5">get</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span> {</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>  <a class="code hl_function" href="namespace_x_d_d_s_p.html#a70350ab317997473442253182bda40ef">dsp_assert</a>(index &gt;= 0 &amp;&amp; index &lt; k.size());</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>  <span class="keywordflow">return</span> k[index].data();</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span> }</div>
</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>};</div>
</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span> </div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span> </div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span> </div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span> </div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span></div>
<div class="foldopen" id="foldopen00853" data-start="{" data-end="};">
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_parameters.html">  853</a></span><span class="keyword">class </span>ConvolutionParameters</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>{</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span> <span class="keywordtype">int</span> iBS {256};</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span> <span class="keywordtype">int</span> dBS {256};</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>  </div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span> <span class="keywordtype">int</span> iFS;</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span> <span class="keywordtype">int</span> dFS;</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span> </div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span> <span class="keywordtype">bool</span> dP {<span class="keyword">false</span>};</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span> </div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span> ConvolutionParameters()</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span> {</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>  setParameters(iBS, dBS);</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span> }</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span> </div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span> <span class="comment">// Set the buffer size and FFT size hint</span></div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span> <span class="keywordtype">void</span> setParameters(<span class="keywordtype">int</span> bufferSize, <span class="keywordtype">int</span> fftHint)</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span> {</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>  iBS = <a class="code hl_function" href="class_x_d_d_s_p_1_1_power_size.html#a05f20587b121b02890d705fb40b0ceeb">PowerSize::nextPowerTwoMinusOne</a>(bufferSize) + 1;</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>  dBS = <a class="code hl_function" href="class_x_d_d_s_p_1_1_power_size.html#a05f20587b121b02890d705fb40b0ceeb">PowerSize::nextPowerTwoMinusOne</a>(fftHint) + 1;</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>  dBS = std::max(iBS, dBS);</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>  </div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>  dP = iBS != dBS;</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>  iFS = 2*iBS;</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>  dFS = 2*dBS;</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span> }</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span> </div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span> <span class="keywordtype">int</span> inputFFTSize()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> iFS; }</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span> <span class="keywordtype">int</span> deferredFFTSize()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> dFS; }</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span> <span class="keywordtype">int</span> inputSize()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> iBS; }</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span> <span class="keywordtype">int</span> deferredSize()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> dBS; }</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span> <span class="keywordtype">bool</span> deferredProcessing()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> dP; }</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>};</div>
</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span> </div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span> </div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span> </div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span> </div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span></div>
<div class="foldopen" id="foldopen00896" data-start="{" data-end="};">
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno"><a class="line" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_impulse_response.html">  896</a></span><span class="keyword">struct </span><a class="code hl_struct" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_impulse_response.html">ImpulseResponse</a></div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>{</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span> <a class="code hl_struct" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html">KernelContainer</a> inputKernels;</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span> <a class="code hl_struct" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html">KernelContainer</a> deferredKernels;</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sampleCount;</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span> </div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span> <span class="comment">// Load an impulse response into the container, with consideration for the convolution parameters.</span></div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span> <span class="keywordtype">void</span> setImpulseResponse(<a class="code hl_class" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_parameters.html">ConvolutionParameters</a> &amp;cp,</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>                         <span class="keyword">const</span> SampleType *impulseSamples,</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size)</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span> {</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>  <span class="keywordflow">if</span> (size &lt; cp.deferredFFTSize()) cp.setParameters(cp.inputSize(), size/2);</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>  sampleCount = size;</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputKernCount = (size/cp.inputSize() + 1);</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>  <span class="keywordflow">if</span> (cp.deferredProcessing() &amp;&amp; cp.deferredSize()/cp.inputSize() &lt; inputKernCount)</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>  {</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>   inputKernCount = cp.deferredSize()/cp.inputSize();</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>  }</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>  computeKernels(inputKernels,</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>                 inputKernCount,</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>                 cp.inputFFTSize(),</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>                 cp.inputSize(),</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>                 size,</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>                 0,</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>                 impulseSamples);</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span> </div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>  <span class="keywordflow">if</span> (cp.deferredProcessing())</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>  {</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> deferredKernCount = size / cp.deferredSize();</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>   computeKernels(deferredKernels,</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>                  deferredKernCount,</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>                  cp.deferredFFTSize(),</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>                  cp.deferredSize(),</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>                  size,</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>                  1,</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>                  impulseSamples);</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>  }</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>  <span class="keywordflow">else</span> deferredKernels.setup(0, 0);</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span> }</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span> </div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span> <span class="keywordtype">void</span> computeKernels(<a class="code hl_struct" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html">KernelContainer</a> &amp;k,</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> count,</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fftSize,</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> segmentSize,</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> totalSize,</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> startPoint,</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>                     <span class="keyword">const</span> SampleType *impulseSamples)</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span> {</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>  k.<a class="code hl_function" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html#abbd3f3daaa17b1b9488a00d775870a82">setup</a>(count, fftSize);</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>  </div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c = startPoint*segmentSize;</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; ++i)</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>  {</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>   k.k[i].assign(fftSize, 0.);</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> start = std::min(c, totalSize - 1);</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cs = std::min(c + segmentSize, totalSize - 1);</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>   <span class="keywordflow">if</span> (start &lt; cs) std::copy(impulseSamples + start, impulseSamples + cs, k.<a class="code hl_function" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html#a6e9ca1d377f5b7726a777d21a73873f5">get</a>(i));</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>   <a class="code hl_function" href="namespace_x_d_d_s_p.html#ab967fac6eda3e8d7d43c4f9db061e1ef">fftDynamicSize</a>(k.<a class="code hl_function" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html#a6e9ca1d377f5b7726a777d21a73873f5">get</a>(i), fftSize);</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>   c += segmentSize;</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>  }</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span> }</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>};</div>
</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span> </div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span> </div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span> </div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span></div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> ConnectorChannelCount&gt;</div>
<div class="foldopen" id="foldopen00970" data-start="{" data-end="};">
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html">  970</a></span><span class="keyword">class </span><a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a1e69f6168bb2b1be0726258eb899c66c">ConvolutionEngine</a></div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>{</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span> <a class="code hl_struct" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_impulse_response.html">ImpulseResponse</a> *imp {<span class="keyword">nullptr</span>};</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span> <a class="code hl_class" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_parameters.html">ConvolutionParameters</a> &amp;cp;</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span> </div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span> <span class="keywordtype">bool</span> startDeferredProcess {<span class="keyword">false</span>};</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span> <span class="keywordtype">bool</span> killDeferredProcess {<span class="keyword">false</span>};</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span> std::mutex dmux;</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span> std::mutex amux;</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span> std::condition_variable deferredProcessTrigger;</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span> <span class="keywordtype">int</span> procBufferInUse {0};</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span> std::array&lt;std::vector&lt;SampleType&gt;, 2&gt; deferProc;</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span> std::thread deferredProcThread;</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span> </div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span> std::vector&lt;SampleType&gt; inputBuffer;</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span> std::vector&lt;SampleType&gt; deferBuffer;</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span> std::vector&lt;SampleType&gt; procBuffer;</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span> std::vector&lt;SampleType&gt; olapBuffer;</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> olapC {0};</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> deferC {0};</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> deferOlapC {0};</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span> <a class="code hl_class" href="class_x_d_d_s_p_1_1_power_size.html">PowerSize</a> olapSize;</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span> </div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span> <span class="keywordtype">void</span> multiplyAndAccumulate(SampleType *input,</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>                            SampleType *irKernel,</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>                            SampleType *proc,</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fftSize,</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> offset)</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span> {</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>  <a class="code hl_function" href="namespace_x_d_d_s_p.html#a301ddf32610b2c3725c8f42064350a23">multiplyFFTs</a>(proc, input, irKernel, fftSize);</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>  <a class="code hl_function" href="namespace_x_d_d_s_p.html#a0759011c633e1819484046214fbc3720">ifftDynamicSize</a>(proc, fftSize);</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c = offset;</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>  {</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>   std::unique_lock lock(amux);</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; fftSize; j++, ++c)</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>   {</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>    olapBuffer[c &amp; olapSize.mask()] += proc[j];</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>   }</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>  }</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span> }</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span> </div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span> <span class="keywordtype">void</span> doConvolution()</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span> {</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fftSize = cp.inputFFTSize();</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> segmentSize = cp.inputSize();</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>  <a class="code hl_function" href="namespace_x_d_d_s_p.html#ab967fac6eda3e8d7d43c4f9db061e1ef">fftDynamicSize</a>(inputBuffer.data(), fftSize, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>  </div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; imp-&gt;inputKernels.size(); ++i)</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>  {</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>   multiplyAndAccumulate(inputBuffer.data(),</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>                         imp-&gt;inputKernels.get(i),</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>                         procBuffer.data(),</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>                         fftSize,</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>                         olapC + segmentSize*i);</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>  }</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span> }</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span> </div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span> <span class="keywordtype">void</span> doDeferredConvolution(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> offset)</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span> {</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>  {</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>   std::unique_lock lock(dmux);</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>   </div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>   std::fill(deferProc[procBufferInUse].begin() + cp.deferredSize(),</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>             deferProc[procBufferInUse].end(),</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>             0.);</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>   <a class="code hl_function" href="namespace_x_d_d_s_p.html#ab967fac6eda3e8d7d43c4f9db061e1ef">fftDynamicSize</a>(deferProc[procBufferInUse].data(), cp.deferredFFTSize(), <span class="keyword">false</span>);</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>   </div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>   multiplyAndAccumulate(deferProc[procBufferInUse].data(),</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>                         imp-&gt;deferredKernels.get(0),</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>                         deferBuffer.data(),</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>                         cp.deferredFFTSize(),</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>                         olapC + offset);</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>   deferOlapC = olapC + offset;</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>   procBufferInUse = 1 - procBufferInUse;</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>   startDeferredProcess = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>  }</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>  deferredProcessTrigger.notify_one();</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span> }</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span> </div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span> <span class="keywordtype">void</span> deferredProcessor()</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span> {</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>  std::unique_lock lock(dmux);</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>  <span class="keywordflow">while</span> (!killDeferredProcess)</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>  {</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>   deferredProcessTrigger.wait(lock, [&amp;]() { <span class="keywordflow">return</span> killDeferredProcess || startDeferredProcess; });</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span> </div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>   <span class="keywordflow">if</span> (startDeferredProcess)</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>   {</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>    <span class="keywordtype">int</span> pbu = 1 - procBufferInUse;</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>    startDeferredProcess = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; imp-&gt;deferredKernels.size(); ++i)</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>    {</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>     multiplyAndAccumulate(deferProc[pbu].data(),</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>                           imp-&gt;deferredKernels.get(i),</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>                           deferBuffer.data(),</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>                           cp.deferredFFTSize(),</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>                           deferOlapC + cp.deferredSize()*i);</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>    }</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>   }</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>  }</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span> }</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>  </div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span> <a class="code hl_class" href="class_x_d_d_s_p_1_1_p_connector.html">PConnector&lt;ConnectorChannelCount&gt;</a> signalIn;</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span> </div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Source&gt;</div>
<div class="foldopen" id="foldopen01085" data-start="{" data-end="}">
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a1e69f6168bb2b1be0726258eb899c66c"> 1085</a></span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a1e69f6168bb2b1be0726258eb899c66c">ConvolutionEngine</a>(<a class="code hl_class" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_parameters.html">ConvolutionParameters</a> &amp;cp, <a class="code hl_class" href="class_x_d_d_s_p_1_1_coupler.html">Coupler&lt;Source, ConnectorChannelCount&gt;</a> &amp;c) :</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span> cp(cp),</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span> deferredProcThread([&amp;]() {deferredProcessor();}),</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span> signalIn(c)</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span> {}</div>
</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span> </div>
<div class="foldopen" id="foldopen01098" data-start="{" data-end="}">
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a087afe37e524c8b99ed95920f30f52e4"> 1098</a></span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a087afe37e524c8b99ed95920f30f52e4">ConvolutionEngine</a>(<a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a1e69f6168bb2b1be0726258eb899c66c">ConvolutionEngine</a> &amp;&amp;rhs) :</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span> cp(rhs.cp),</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span> deferredProcThread([&amp;]() {deferredProcessor();}),</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span> signalIn(rhs.signalIn)</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span> {}</div>
</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span> </div>
<div class="foldopen" id="foldopen01110" data-start="{" data-end="}">
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#ab33ca15cdcf294a4d1e185df20cd6de3"> 1110</a></span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#ab33ca15cdcf294a4d1e185df20cd6de3">~ConvolutionEngine</a>()</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span> {</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>  {</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>   std::unique_lock lock(dmux);</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>   killDeferredProcess = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>  }</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>  deferredProcessTrigger.notify_one();</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>  <span class="keywordflow">if</span> (deferredProcThread.joinable()) deferredProcThread.join();</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span> }</div>
</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span> </div>
<div class="foldopen" id="foldopen01125" data-start="{" data-end="}">
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a030ba1d9186e8cc9d0b7fb6bc9214f22"> 1125</a></span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a030ba1d9186e8cc9d0b7fb6bc9214f22">setImpulseResponse</a>(<a class="code hl_struct" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_impulse_response.html">ImpulseResponse</a> &amp;impulse)</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span> {</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>  std::unique_lock lock(dmux);</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>  imp = &amp;impulse;</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span> }</div>
</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span> </div>
<div class="foldopen" id="foldopen01136" data-start="{" data-end="}">
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#acfc03d50226dda67953c7d2ad6c5f573"> 1136</a></span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#acfc03d50226dda67953c7d2ad6c5f573">initialise</a>()</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span> {</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>  {</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>   std::unique_lock lock(dmux);</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>   procBuffer.resize(cp.deferredFFTSize());</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>   inputBuffer.resize(cp.inputFFTSize());</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>   deferBuffer.resize(cp.deferredFFTSize());</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>   deferProc[0].resize(cp.deferredFFTSize());</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>   deferProc[1].resize(cp.deferredFFTSize());</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>   <span class="keywordflow">if</span> (imp)</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>   {</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> overlapSize = cp.deferredSize() + imp-&gt;sampleCount + cp.deferredFFTSize();</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>    olapSize.setToNextPowerTwo(overlapSize);</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>    olapBuffer.resize(olapSize.size());</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>   }</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>  }</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span> </div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>  <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a1fe3b6558144b419f1bd679ca0fc0502">reset</a>();</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span> }</div>
</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span> </div>
<div class="foldopen" id="foldopen01161" data-start="{" data-end="}">
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a1fe3b6558144b419f1bd679ca0fc0502"> 1161</a></span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a1fe3b6558144b419f1bd679ca0fc0502">reset</a>()</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span> {</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>  std::unique_lock lock(dmux);</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>  deferC = 0;</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>  procBufferInUse = 0;</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>  <span class="keywordflow">if</span> (imp)</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>  {</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>   olapBuffer.assign(olapSize.size(), 0.);</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>   olapC = 0;</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>  }</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span> }</div>
</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span> </div>
<div class="foldopen" id="foldopen01181" data-start="{" data-end="}">
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a338d1761796779fc2eac813318891231"> 1181</a></span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a338d1761796779fc2eac813318891231">processSamples</a>(<span class="keywordtype">int</span> channel,</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>                     <span class="keywordtype">int</span> startPoint,</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>                     SampleType *output,</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sampleCount)</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span> {</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>  <span class="keywordflow">if</span> (imp)</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>  {</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>   {</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>    <span class="keywordflow">for</span> (; i &lt; sampleCount; ++i) inputBuffer[i] = signalIn(channel, i + startPoint);</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>    <span class="keywordflow">for</span> (; i &lt; cp.inputFFTSize(); ++i) inputBuffer[i] = 0.;</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>   }</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>   </div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>   <span class="keywordflow">if</span> (cp.deferredProcessing())</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>   {</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>    <span class="keywordflow">for</span> (; i &lt; sampleCount &amp;&amp; deferC &lt; cp.deferredSize(); ++i, ++deferC)</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>    {</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>     deferProc[procBufferInUse][deferC] = inputBuffer[i];</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>    }</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>    <span class="keywordflow">if</span> (deferC == cp.deferredSize())</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>    {</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>     deferC = 0;</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>     doDeferredConvolution(i);</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>     <span class="keywordflow">for</span> (; i &lt; sampleCount &amp;&amp; deferC &lt; cp.deferredSize(); ++i, ++deferC)</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>     {</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>      deferProc[procBufferInUse][deferC] = inputBuffer[i];</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>     }</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>    }</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>   }</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>   </div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>   doConvolution();</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>   </div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sampleCount; ++i)</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>   {</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>    output[i] = olapBuffer[olapC];</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>    olapBuffer[olapC] = 0.;</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>    olapC = (olapC + 1) &amp; olapSize.mask();</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>   }</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>  }</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span> }</div>
</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>};</div>
</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span> </div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span> </div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span> </div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span> </div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span> </div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>}</div>
</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span> </div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span> </div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span> </div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span> </div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span> </div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span> </div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span> </div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span> </div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span></div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> SignalIn&gt;</div>
<div class="foldopen" id="foldopen01246" data-start="{" data-end="};">
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_filter.html"> 1246</a></span><span class="keyword">class </span>ConvolutionFilter : <span class="keyword">public</span> Component&lt;ConvolutionFilter&lt;SignalIn&gt;&gt;, <span class="keyword">public</span> <a class="code hl_class" href="class_x_d_d_s_p_1_1_parameters_1_1_parameter_listener.html">Parameters::ParameterListener</a></div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>{</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span> <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> Count = SignalIn::Count;</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span> </div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span> <span class="keywordtype">bool</span> initialised = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span> </div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span> <span class="keyword">struct </span>ImpulseSample</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span> {</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>  <span class="keywordtype">bool</span> set {<span class="keyword">false</span>};</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>  SampleType* pointerToSample {<span class="keyword">nullptr</span>};</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> length {0};</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span> };</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span> </div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span> <span class="keywordtype">int</span> selectedFFTSize {256};</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span> <a class="code hl_class" href="class_x_d_d_s_p_1_1_parameters.html">Parameters</a> &amp;dsp;</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span> <a class="code hl_class" href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_parameters.html">ConvolutionEngine::ConvolutionParameters</a> cp;</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span> </div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span> std::array&lt;ImpulseSample, Count&gt; samples;</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span> std::vector&lt;ConvolutionEngine::ImpulseResponse&gt; imp;</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span> std::vector&lt;ConvolutionEngine::ConvolutionEngine&lt;Count&gt;&gt; eng;</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span> </div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span> std::mutex mtx;</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span> </div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span> </div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span> SignalIn signalIn;</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span> </div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span> <a class="code hl_class" href="class_x_d_d_s_p_1_1_output.html">Output&lt;Count&gt;</a> signalOut;</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span> </div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span> <span class="comment">// Upon construction, the convolution engine starts multiple threads to perform background processing on signal data. These threads are automatically stopped upon destruction of the component, however they currently wait on the stopping thread indefinitely, so a stuck thread might result in a hang.</span></div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span> ConvolutionFilter(<a class="code hl_class" href="class_x_d_d_s_p_1_1_parameters.html">Parameters</a> &amp;p, SignalIn _signalIn) :</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span> <a class="code hl_class" href="class_x_d_d_s_p_1_1_parameters_1_1_parameter_listener.html">Parameters::ParameterListener</a>(p),</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span> dsp(p),</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span> signalIn(_signalIn),</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span> signalOut(p)</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span> {</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>  <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#a5a662845c9f51e1100baaa666c08862d">resetConvolution</a>();</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>  <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#af331668aa8c4dfbba940d8eb0b57bedc">updateBufferSize</a>(p.<a class="code hl_function" href="class_x_d_d_s_p_1_1_parameters.html#a8392a7b9bdd5e1e0a5f07a78673ef5d7">bufferSize</a>());</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Count; ++i)</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>  {</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>   eng.emplace_back(cp, signalIn);</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>  }</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span> }</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span> </div>
<div class="foldopen" id="foldopen01292" data-start="{" data-end="}">
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_filter.html#a213f98fb70efb4fcad8f784fac03a902"> 1292</a></span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#a213f98fb70efb4fcad8f784fac03a902">reset</a>()<span class="keyword"> override</span></div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span><span class="keyword"> </span>{</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>  std::lock_guard&lt;std::mutex&gt; lock(mtx);</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;e : eng) e.reset();</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>  signalOut.reset();</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span> }</div>
</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span> </div>
<div class="foldopen" id="foldopen01303" data-start="{" data-end="}">
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_filter.html#a5a662845c9f51e1100baaa666c08862d"> 1303</a></span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#a5a662845c9f51e1100baaa666c08862d">resetConvolution</a>()</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span> {</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>  std::lock_guard&lt;std::mutex&gt; lock(mtx);</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>  initialised = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>  samples.fill(ImpulseSample());</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>  imp.clear();</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>  imp.assign(Count, <a class="code hl_struct" href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_impulse_response.html">ConvolutionEngine::ImpulseResponse</a>());</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span> }</div>
</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span> </div>
<div class="foldopen" id="foldopen01321" data-start="{" data-end="}">
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_filter.html#a3547636bf444f76735f99d463b38b361"> 1321</a></span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#a3547636bf444f76735f99d463b38b361">setImpulse</a>(<span class="keywordtype">int</span> index, SampleType* data, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> length)</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span> {</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>  <a class="code hl_function" href="namespace_x_d_d_s_p.html#a70350ab317997473442253182bda40ef">dsp_assert</a>(index &gt;= 0 &amp;&amp; index &lt; Count);</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>  samples[index].set = data != <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>  samples[index].pointerToSample = data;</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>  samples[index].length = length;</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span> }</div>
</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span> </div>
<div class="foldopen" id="foldopen01329" data-start="{" data-end="}">
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_filter.html#af331668aa8c4dfbba940d8eb0b57bedc"> 1329</a></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#af331668aa8c4dfbba940d8eb0b57bedc">updateBufferSize</a>(<span class="keywordtype">int</span> bs)<span class="keyword"> override</span></div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span><span class="keyword"> </span>{</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>  <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#a72566e00c2d15e6ae0363c49035a6c63">initialiseConvolution</a>();</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span> }</div>
</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span></div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_filter.html#a52d7dcb1c939226b0bd0de4bcfca015c"> 1342</a></span> <span class="keywordtype">bool</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#a52d7dcb1c939226b0bd0de4bcfca015c">isInitlialised</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> initialised; }</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span> </div>
<div class="foldopen" id="foldopen01351" data-start="{" data-end="}">
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_filter.html#aa1342b748e937f95dadd15a1c8ec8124"> 1351</a></span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#aa1342b748e937f95dadd15a1c8ec8124">setFFTHint</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hint)</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span> {</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>  selectedFFTSize = hint;</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>  <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#a72566e00c2d15e6ae0363c49035a6c63">initialiseConvolution</a>();</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span> }</div>
</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span> </div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_filter.html#a54e32ab6433a1d4f7a412f1a04eda9fa"> 1362</a></span> <span class="keywordtype">int</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#a54e32ab6433a1d4f7a412f1a04eda9fa">getFFTSize</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> cp.deferredFFTSize(); }</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span></div>
<div class="foldopen" id="foldopen01369" data-start="{" data-end="}">
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_filter.html#a72566e00c2d15e6ae0363c49035a6c63"> 1369</a></span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#a72566e00c2d15e6ae0363c49035a6c63">initialiseConvolution</a>()</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span> {</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>  std::lock_guard&lt;std::mutex&gt; lock(mtx);</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>  cp.setParameters(dsp.bufferSize(), selectedFFTSize);</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>  </div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>  initialised = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>  <span class="keywordflow">if</span> (!samples[0].set) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>  </div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Count; ++i)</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>  {</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>   <span class="keywordflow">if</span> (samples[i].set)</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>   {</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>    imp[i].setImpulseResponse(cp, samples[i].pointerToSample, samples[i].length);</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>    eng[i].setImpulseResponse(imp[i]);</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>   }</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>   <span class="keywordflow">else</span> eng[i].setImpulseResponse(imp[0]);</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>  }</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>  </div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;e: eng) e.initialise();</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>  </div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>  initialised = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span> }</div>
</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span> </div>
<div class="foldopen" id="foldopen01392" data-start="{" data-end="}">
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"><a class="line" href="class_x_d_d_s_p_1_1_convolution_filter.html#ad9d264a42dd701a22f960da16588ff9a"> 1392</a></span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_x_d_d_s_p_1_1_convolution_filter.html#ad9d264a42dd701a22f960da16588ff9a">stepProcess</a>(<span class="keywordtype">int</span> startPoint, <span class="keywordtype">int</span> sampleCount)<span class="keyword"> override</span></div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span><span class="keyword"> </span>{</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>  std::lock_guard&lt;std::mutex&gt; lock(mtx);</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>  <span class="comment">// If there are no kernels loaded, simply pass signal through</span></div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>  <span class="keywordflow">if</span> (!initialised)</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>  {</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; Count; ++c)</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>   {</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = startPoint, s = sampleCount; s--; ++i)</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>    {</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>     signalOut.buffer(c, i) = signalIn(c, i);</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>    }</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>   }</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>  }</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>  </div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>  <span class="comment">// otherwise process the inputs</span></div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>  {</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; Count; ++c)</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>   {</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>    eng[c].processSamples(c,</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>                          startPoint,</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>                          signalOut.buffer[c] + startPoint,</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>                          sampleCount);</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>   }</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>  }</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span> }</div>
</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>};</div>
</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span> </div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span> </div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span> </div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span> </div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span> </div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span> </div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span> </div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span> </div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span> </div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span> </div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>}</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span> </div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span><span class="preprocessor">#endif </span><span class="comment">/* FFT_h */</span><span class="preprocessor"></span></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_auto_correlator_html_a2e65224404879ef93088566fca7ed9f0"><div class="ttname"><a href="class_x_d_d_s_p_1_1_auto_correlator.html#a2e65224404879ef93088566fca7ed9f0">XDDSP::AutoCorrelator::autoCorrelate</a></div><div class="ttdeci">SampleType autoCorrelate(std::array&lt; SampleType, n &gt; &amp;data)</div><div class="ttdoc">Do autocorrelation on the input data in a std::array.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:714</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_auto_correlator_html_a3596b2dcaf3a3b0a6309288d8874eee4"><div class="ttname"><a href="class_x_d_d_s_p_1_1_auto_correlator.html#a3596b2dcaf3a3b0a6309288d8874eee4">XDDSP::AutoCorrelator::autoCorrelate</a></div><div class="ttdeci">SampleType autoCorrelate(std::vector&lt; SampleType &gt; &amp;data)</div><div class="ttdoc">Do autocorrelation on the input data in a std::vector.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:723</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_auto_correlator_html_a8287fc31b918f38e058d8593c414dc36"><div class="ttname"><a href="class_x_d_d_s_p_1_1_auto_correlator.html#a8287fc31b918f38e058d8593c414dc36">XDDSP::AutoCorrelator::AutoCorrelator</a></div><div class="ttdeci">AutoCorrelator(Parameters &amp;p)</div><div class="ttdoc">Construct a new Auto Correlator object.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:684</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_auto_correlator_html_afa38ee688de74d2b6372b08df8fbed71"><div class="ttname"><a href="class_x_d_d_s_p_1_1_auto_correlator.html#afa38ee688de74d2b6372b08df8fbed71">XDDSP::AutoCorrelator::autoCorrelate</a></div><div class="ttdeci">SampleType autoCorrelate(SampleType *data, unsigned long length)</div><div class="ttdoc">Do autocorrelation on the input data. The input data is destroyed.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:694</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine_html"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html">XDDSP::ConvolutionEngine::ConvolutionEngine</a></div><div class="ttdoc">An internal class which encapsulates a convolution engine for one signal.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:971</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine_html_a030ba1d9186e8cc9d0b7fb6bc9214f22"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a030ba1d9186e8cc9d0b7fb6bc9214f22">XDDSP::ConvolutionEngine::ConvolutionEngine::setImpulseResponse</a></div><div class="ttdeci">void setImpulseResponse(ImpulseResponse &amp;impulse)</div><div class="ttdoc">Set the Impulse Response object.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1125</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine_html_a087afe37e524c8b99ed95920f30f52e4"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a087afe37e524c8b99ed95920f30f52e4">XDDSP::ConvolutionEngine::ConvolutionEngine::ConvolutionEngine</a></div><div class="ttdeci">ConvolutionEngine(ConvolutionEngine &amp;&amp;rhs)</div><div class="ttdoc">Construct a copy of a Convolution Engine object.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1098</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine_html_a1e69f6168bb2b1be0726258eb899c66c"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a1e69f6168bb2b1be0726258eb899c66c">XDDSP::ConvolutionEngine::ConvolutionEngine::ConvolutionEngine</a></div><div class="ttdeci">ConvolutionEngine(ConvolutionParameters &amp;cp, Coupler&lt; Source, ConnectorChannelCount &gt; &amp;c)</div><div class="ttdoc">Construct a new Convolution Engine object.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1085</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine_html_a1fe3b6558144b419f1bd679ca0fc0502"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a1fe3b6558144b419f1bd679ca0fc0502">XDDSP::ConvolutionEngine::ConvolutionEngine::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdoc">Reset the convolution engine.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1161</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine_html_a338d1761796779fc2eac813318891231"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#a338d1761796779fc2eac813318891231">XDDSP::ConvolutionEngine::ConvolutionEngine::processSamples</a></div><div class="ttdeci">void processSamples(int channel, int startPoint, SampleType *output, unsigned int sampleCount)</div><div class="ttdoc">Process some samples from the input.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1181</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine_html_ab33ca15cdcf294a4d1e185df20cd6de3"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#ab33ca15cdcf294a4d1e185df20cd6de3">XDDSP::ConvolutionEngine::ConvolutionEngine::~ConvolutionEngine</a></div><div class="ttdeci">~ConvolutionEngine()</div><div class="ttdoc">Stop the processing thread, then destroy the Convolution Engine object.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1110</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine_html_acfc03d50226dda67953c7d2ad6c5f573"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_engine.html#acfc03d50226dda67953c7d2ad6c5f573">XDDSP::ConvolutionEngine::ConvolutionEngine::initialise</a></div><div class="ttdeci">void initialise()</div><div class="ttdoc">Initialise the convolution engine.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1136</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_parameters_html"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_engine_1_1_convolution_parameters.html">XDDSP::ConvolutionEngine::ConvolutionParameters</a></div><div class="ttdoc">An internal class for managing the parameters of the convolution engine.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:854</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_filter_html_a213f98fb70efb4fcad8f784fac03a902"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_filter.html#a213f98fb70efb4fcad8f784fac03a902">XDDSP::ConvolutionFilter::reset</a></div><div class="ttdeci">void reset() override</div><div class="ttdoc">This can be implemented to contain the code used to reset the component to a default known state.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1292</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_filter_html_a3547636bf444f76735f99d463b38b361"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_filter.html#a3547636bf444f76735f99d463b38b361">XDDSP::ConvolutionFilter::setImpulse</a></div><div class="ttdeci">void setImpulse(int index, SampleType *data, unsigned int length)</div><div class="ttdoc">Set the impulse response data for one channel.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1321</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_filter_html_a52d7dcb1c939226b0bd0de4bcfca015c"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_filter.html#a52d7dcb1c939226b0bd0de4bcfca015c">XDDSP::ConvolutionFilter::isInitlialised</a></div><div class="ttdeci">bool isInitlialised() const</div><div class="ttdoc">Returns whether the convolution engine is fully initialised.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1342</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_filter_html_a54e32ab6433a1d4f7a412f1a04eda9fa"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_filter.html#a54e32ab6433a1d4f7a412f1a04eda9fa">XDDSP::ConvolutionFilter::getFFTSize</a></div><div class="ttdeci">int getFFTSize() const</div><div class="ttdoc">Return the current size of the FFT chunk being used by the convolution engine.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1362</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_filter_html_a5a662845c9f51e1100baaa666c08862d"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_filter.html#a5a662845c9f51e1100baaa666c08862d">XDDSP::ConvolutionFilter::resetConvolution</a></div><div class="ttdeci">void resetConvolution()</div><div class="ttdoc">Clear the convolution engines, unload the impulse response samples and bypass the component.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1303</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_filter_html_a72566e00c2d15e6ae0363c49035a6c63"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_filter.html#a72566e00c2d15e6ae0363c49035a6c63">XDDSP::ConvolutionFilter::initialiseConvolution</a></div><div class="ttdeci">void initialiseConvolution()</div><div class="ttdoc">Prepare for convolution.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1369</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_filter_html_aa1342b748e937f95dadd15a1c8ec8124"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_filter.html#aa1342b748e937f95dadd15a1c8ec8124">XDDSP::ConvolutionFilter::setFFTHint</a></div><div class="ttdeci">void setFFTHint(unsigned int hint)</div><div class="ttdoc">Set a hint for the FFT size to be used by the convolution engine.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1351</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_filter_html_ad9d264a42dd701a22f960da16588ff9a"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_filter.html#ad9d264a42dd701a22f960da16588ff9a">XDDSP::ConvolutionFilter::stepProcess</a></div><div class="ttdeci">void stepProcess(int startPoint, int sampleCount) override</div><div class="ttdoc">Is called repeatedly by Component::process with the start point incremented by step size....</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1392</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_convolution_filter_html_af331668aa8c4dfbba940d8eb0b57bedc"><div class="ttname"><a href="class_x_d_d_s_p_1_1_convolution_filter.html#af331668aa8c4dfbba940d8eb0b57bedc">XDDSP::ConvolutionFilter::updateBufferSize</a></div><div class="ttdeci">virtual void updateBufferSize(int bs) override</div><div class="ttdoc">Get notified of an update to the buffer size.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:1329</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_coupler_html"><div class="ttname"><a href="class_x_d_d_s_p_1_1_coupler.html">XDDSP::Coupler</a></div><div class="ttdoc">A template class which encapsulates the connection paradigm.</div><div class="ttdef"><b>Definition</b> XDDSP_Classes.h:44</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_dynamic_auto_correlator_html_a11a090d6e3b03be1ccecc92b2b71ed1d"><div class="ttname"><a href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#a11a090d6e3b03be1ccecc92b2b71ed1d">XDDSP::DynamicAutoCorrelator::setBufferSize</a></div><div class="ttdeci">void setBufferSize(unsigned long bufferSize)</div><div class="ttdoc">Set the size of the buffer.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:760</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_dynamic_auto_correlator_html_a93da389f639dcd5faed37b126f9a1ea5"><div class="ttname"><a href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#a93da389f639dcd5faed37b126f9a1ea5">XDDSP::DynamicAutoCorrelator::autoCorrelate</a></div><div class="ttdeci">SampleType autoCorrelate(std::vector&lt; SampleType &gt; &amp;data)</div><div class="ttdoc">Do autocorrelation on the input data in a std::vector.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:803</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_dynamic_auto_correlator_html_ac05355d6e611550d757a4384e809291b"><div class="ttname"><a href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#ac05355d6e611550d757a4384e809291b">XDDSP::DynamicAutoCorrelator::DynamicAutoCorrelator</a></div><div class="ttdeci">DynamicAutoCorrelator(Parameters &amp;p)</div><div class="ttdoc">Construct a new Dynamic Auto Correlator object.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:752</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_dynamic_auto_correlator_html_ae481b84d7754d80e6d099d8966201c50"><div class="ttname"><a href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#ae481b84d7754d80e6d099d8966201c50">XDDSP::DynamicAutoCorrelator::autoCorrelate</a></div><div class="ttdeci">SampleType autoCorrelate(std::array&lt; SampleType, n &gt; &amp;data)</div><div class="ttdoc">Do autocorrelation on the input data in a std::array.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:794</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_dynamic_auto_correlator_html_af67e952bf8bdeb915e8e262a0c290430"><div class="ttname"><a href="class_x_d_d_s_p_1_1_dynamic_auto_correlator.html#af67e952bf8bdeb915e8e262a0c290430">XDDSP::DynamicAutoCorrelator::autoCorrelate</a></div><div class="ttdeci">SampleType autoCorrelate(SampleType *data, unsigned long length)</div><div class="ttdoc">Do autocorrelation on the input data. The input data is destroyed.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:773</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_intersection_estimator_html"><div class="ttname"><a href="class_x_d_d_s_p_1_1_intersection_estimator.html">XDDSP::IntersectionEstimator</a></div><div class="ttdoc">A class for estimating the intersection of a cubic waveform and flat line fixed at some value.</div><div class="ttdef"><b>Definition</b> XDDSP_Functions.h:784</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_intersection_estimator_html_ad235d4e66a6bd90de32afa1b0ad1a808"><div class="ttname"><a href="class_x_d_d_s_p_1_1_intersection_estimator.html#ad235d4e66a6bd90de32afa1b0ad1a808">XDDSP::IntersectionEstimator::setSampleValues</a></div><div class="ttdeci">void setSampleValues(SampleType xm2, SampleType xm1, SampleType x1, SampleType x2)</div><div class="ttdoc">Set the samples that define the cubic waveform.</div><div class="ttdef"><b>Definition</b> XDDSP_Functions.h:810</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_output_html"><div class="ttname"><a href="class_x_d_d_s_p_1_1_output.html">XDDSP::Output</a></div><div class="ttdoc">An output which encapsulates an output buffer inside a coupler so that it can be readily connected to...</div><div class="ttdef"><b>Definition</b> XDDSP_Classes.h:166</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_p_connector_html"><div class="ttname"><a href="class_x_d_d_s_p_1_1_p_connector.html">XDDSP::PConnector</a></div><div class="ttdoc">A connector which can be connected or reconnected to another coupler type at run time.</div><div class="ttdef"><b>Definition</b> XDDSP_Inputs.h:85</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_parameters_1_1_parameter_listener_html"><div class="ttname"><a href="class_x_d_d_s_p_1_1_parameters_1_1_parameter_listener.html">XDDSP::Parameters::ParameterListener</a></div><div class="ttdoc">This class is the base class for all objects which need to listen to a Parameters object.</div><div class="ttdef"><b>Definition</b> XDDSP_Parameters.h:58</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_parameters_html"><div class="ttname"><a href="class_x_d_d_s_p_1_1_parameters.html">XDDSP::Parameters</a></div><div class="ttdoc">An object which encapsulates all of the basic parameters of a DSP network.</div><div class="ttdef"><b>Definition</b> XDDSP_Parameters.h:35</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_parameters_html_a8392a7b9bdd5e1e0a5f07a78673ef5d7"><div class="ttname"><a href="class_x_d_d_s_p_1_1_parameters.html#a8392a7b9bdd5e1e0a5f07a78673ef5d7">XDDSP::Parameters::bufferSize</a></div><div class="ttdeci">int bufferSize() const</div><div class="ttdoc">Get the current buffer size.</div><div class="ttdef"><b>Definition</b> XDDSP_Parameters.h:256</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_power_size_html"><div class="ttname"><a href="class_x_d_d_s_p_1_1_power_size.html">XDDSP::PowerSize</a></div><div class="ttdoc">A class containing commonly used functionality in relation to powers of two.</div><div class="ttdef"><b>Definition</b> XDDSP_Functions.h:558</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_power_size_html_a05f20587b121b02890d705fb40b0ceeb"><div class="ttname"><a href="class_x_d_d_s_p_1_1_power_size.html#a05f20587b121b02890d705fb40b0ceeb">XDDSP::PowerSize::nextPowerTwoMinusOne</a></div><div class="ttdeci">static uint32_t nextPowerTwoMinusOne(uint32_t rs)</div><div class="ttdoc">Make a mask by finding the next power of two higher than the target value and subtracting one.</div><div class="ttdef"><b>Definition</b> XDDSP_Functions.h:650</div></div>
<div class="ttc" id="aclass_x_d_d_s_p_1_1_window_function_1_1_gauss_html"><div class="ttname"><a href="class_x_d_d_s_p_1_1_window_function_1_1_gauss.html">XDDSP::WindowFunction::Gauss</a></div><div class="ttdoc">Produce a Gauss window.</div><div class="ttdef"><b>Definition</b> XDDSP_WindowFunctions.h:165</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_1_1_f_f_t_constants_html"><div class="ttname"><a href="namespace_x_d_d_s_p_1_1_f_f_t_constants.html">XDDSP::FFTConstants</a></div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:24</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html"><div class="ttname"><a href="namespace_x_d_d_s_p.html">XDDSP</a></div><div class="ttdef"><b>Definition</b> XDDSP_Analysis.h:28</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_a0759011c633e1819484046214fbc3720"><div class="ttname"><a href="namespace_x_d_d_s_p.html#a0759011c633e1819484046214fbc3720">XDDSP::ifftDynamicSize</a></div><div class="ttdeci">void ifftDynamicSize(T *data, unsigned long n)</div><div class="ttdoc">Transform an FFT back into the time domain.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:207</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_a13223a5b4d04516032a1c4f98aeedfeb"><div class="ttname"><a href="namespace_x_d_d_s_p.html#a13223a5b4d04516032a1c4f98aeedfeb">XDDSP::multiplyAndAddFFTs</a></div><div class="ttdeci">void multiplyAndAddFFTs(T *output, T *in1, T *in2, unsigned long n)</div><div class="ttdoc">Multiply two FFTs together and add the result to another FFT result.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:495</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_a2f46009fa77b26f0939f3f02d9db9d8d"><div class="ttname"><a href="namespace_x_d_d_s_p.html#a2f46009fa77b26f0939f3f02d9db9d8d">XDDSP::getComplexSample</a></div><div class="ttdeci">std::pair&lt; T, T &gt; getComplexSample(T *data, unsigned long index, unsigned long n)</div><div class="ttdoc">Extract a complex sample from an FFT result.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:428</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_a301ddf32610b2c3725c8f42064350a23"><div class="ttname"><a href="namespace_x_d_d_s_p.html#a301ddf32610b2c3725c8f42064350a23">XDDSP::multiplyFFTs</a></div><div class="ttdeci">void multiplyFFTs(T *output, T *in1, T *in2, unsigned long n)</div><div class="ttdoc">Perform a complex multiplication of two FFTs.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:454</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_a32fa51674b6f683796cc7417542e97dc"><div class="ttname"><a href="namespace_x_d_d_s_p.html#a32fa51674b6f683796cc7417542e97dc">XDDSP::applyWindowFunction</a></div><div class="ttdeci">void applyWindowFunction(WindowType window, T *data, unsigned long length)</div><div class="ttdoc">Apply a window function to samples inside an array.</div><div class="ttdef"><b>Definition</b> XDDSP_WindowFunctions.h:213</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_a5b9681700449b15a061db6007d0815c2"><div class="ttname"><a href="namespace_x_d_d_s_p.html#a5b9681700449b15a061db6007d0815c2">XDDSP::autoCorrelateStaticSizeHalved</a></div><div class="ttdeci">T autoCorrelateStaticSizeHalved(std::array&lt; T, n &gt; &amp;data)</div><div class="ttdoc">Do autocorrelation on the input data in a std::array. The input data is destroyed.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:648</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_a6cf696b87a8fbae2251aa09ca0689104"><div class="ttname"><a href="namespace_x_d_d_s_p.html#a6cf696b87a8fbae2251aa09ca0689104">XDDSP::fftStaticSize</a></div><div class="ttdeci">void fftStaticSize(std::array&lt; T, n &gt; &amp;data, bool normalise=true)</div><div class="ttdoc">Compute an FFT on data in a std::array.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:352</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_a70350ab317997473442253182bda40ef"><div class="ttname"><a href="namespace_x_d_d_s_p.html#a70350ab317997473442253182bda40ef">XDDSP::dsp_assert</a></div><div class="ttdeci">void dsp_assert(bool condition)</div><div class="ttdoc">A static global method to enable assertion checking in debug builds.</div><div class="ttdef"><b>Definition</b> XDDSP_Types.h:109</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_a928440e390d14ed481c7743382c72c7f"><div class="ttname"><a href="namespace_x_d_d_s_p.html#a928440e390d14ed481c7743382c72c7f">XDDSP::magnitudeAt</a></div><div class="ttdeci">T magnitudeAt(T *data, unsigned long index, unsigned long n)</div><div class="ttdoc">Calculate the magnitude of one complex number in the FFT result.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:535</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_aaf6a3faaf5f63e44e0684a1f6f632427"><div class="ttname"><a href="namespace_x_d_d_s_p.html#aaf6a3faaf5f63e44e0684a1f6f632427">XDDSP::ifftStaticSize</a></div><div class="ttdeci">void ifftStaticSize(std::array&lt; T, n &gt; &amp;data)</div><div class="ttdoc">Perform an inverse FFT on samples in a std::array.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:390</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_ab967fac6eda3e8d7d43c4f9db061e1ef"><div class="ttname"><a href="namespace_x_d_d_s_p.html#ab967fac6eda3e8d7d43c4f9db061e1ef">XDDSP::fftDynamicSize</a></div><div class="ttdeci">void fftDynamicSize(T *data, unsigned long n, bool normalise=true)</div><div class="ttdoc">Compute an FFT inside an arbitrary buffer.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:44</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_ad2f74eac40d5e02fc4b1d798f850f7a7"><div class="ttname"><a href="namespace_x_d_d_s_p.html#ad2f74eac40d5e02fc4b1d798f850f7a7">XDDSP::autoCorrelateDynamicSizeHalved</a></div><div class="ttdeci">T autoCorrelateDynamicSizeHalved(T *data, unsigned long n)</div><div class="ttdoc">Do autocorrelation on the input data. The input data is destroyed.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:591</div></div>
<div class="ttc" id="anamespace_x_d_d_s_p_html_af74876c324ecde0826f5c56df11061af"><div class="ttname"><a href="namespace_x_d_d_s_p.html#af74876c324ecde0826f5c56df11061af">XDDSP::calculateMagnitudes</a></div><div class="ttdeci">void calculateMagnitudes(T *data, unsigned long n)</div><div class="ttdoc">Calculate every magnitude in an FFT. The FFT is overwritten with magnitudes in the first half of the ...</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:559</div></div>
<div class="ttc" id="astruct_x_d_d_s_p_1_1_convolution_engine_1_1_impulse_response_html"><div class="ttname"><a href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_impulse_response.html">XDDSP::ConvolutionEngine::ImpulseResponse</a></div><div class="ttdoc">The data structure for storing impulse response data.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:897</div></div>
<div class="ttc" id="astruct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container_html"><div class="ttname"><a href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html">XDDSP::ConvolutionEngine::KernelContainer</a></div><div class="ttdoc">An internal container for storing convolution kernels.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:824</div></div>
<div class="ttc" id="astruct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container_html_a6e9ca1d377f5b7726a777d21a73873f5"><div class="ttname"><a href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html#a6e9ca1d377f5b7726a777d21a73873f5">XDDSP::ConvolutionEngine::KernelContainer::get</a></div><div class="ttdeci">SampleType * get(unsigned int index)</div><div class="ttdoc">Return a pointer to convolution kernel data.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:838</div></div>
<div class="ttc" id="astruct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container_html_abbd3f3daaa17b1b9488a00d775870a82"><div class="ttname"><a href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html#abbd3f3daaa17b1b9488a00d775870a82">XDDSP::ConvolutionEngine::KernelContainer::setup</a></div><div class="ttdeci">void setup(unsigned int kernelCount, unsigned int kernelSize)</div><div class="ttdoc">Set up the container.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:828</div></div>
<div class="ttc" id="astruct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container_html_ac0cc7eb9849f491a5e79e29acc0c7247"><div class="ttname"><a href="struct_x_d_d_s_p_1_1_convolution_engine_1_1_kernel_container.html#ac0cc7eb9849f491a5e79e29acc0c7247">XDDSP::ConvolutionEngine::KernelContainer::size</a></div><div class="ttdeci">unsigned int size()</div><div class="ttdoc">Get the size of the container.</div><div class="ttdef"><b>Definition</b> XDDSP_FFT.h:835</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>XDDSP_FFT.h</b></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
